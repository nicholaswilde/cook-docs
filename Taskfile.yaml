---
version: '3'

tasks:
  clean:
    desc: Clean
    cmds:
      - rm -f cook-docs
      - rm -f dist
  coverage:
    desc: Go test coverage
    cmds:
      - go test -coverprofile=coverage.out ./...
  dist:
    desc: Create go releases
    cmds:
      - goreleaser release --rm-dist --snapshot --skip-sign
  deps:
    desc: Download dependencies
    cmds:
      - go get -d ./...
  dry-run:
    desc: Perform a dry run
    cmds:
      - go run -v ./... --recipe-search-root cmd/cook-docs/testdata --dry-run
  debug:
    desc: Run go program
    cmds:
      - >
        go run -v ./... --recipe-search-root cmd/cook-docs/testdata \
        --template-files cmd/cook-docs/testdata/recipe.md.gotmpl \
        --log-level debug --dry-run
  fmt:
    desc: Print the names of the files that are modified.
    cmds:
      - go fmt ./...
  help:
    desc: Show app help
    cmds:
      - go run ./... --help
  lint:
    desc: Lint the project
    cmds:
      - yamllint .
  run:
    desc: Run go program
    cmds:
      - go run -v ./... --recipe-search-root cmd/cook-docs/testdata
  serve:
    desc: Serve a mkdocs server
    cmds:
      - mkdocs serve
  test:
    desc: Run go tests
    cmds:
      - go test -v ./...
  vet:
    desc: Vet
    cmds:
      - go vet ./...
  vendor:
    desc: Generate vendor
    cmds:
      - go mod vendor
      - go mod tidy
  default:
    desc: Lists tasks with or without a description
    cmds:
      - task -a
    silent: true
